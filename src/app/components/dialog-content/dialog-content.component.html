<mat-dialog-content>
  <div class="container-fluid w-100 body">
    <div class="row">
          <div class="col-12">
            <h2 mat-dialog-title class="dialog-title knowledge-base">
              {{ data.status === 'inclusao' ? 'Inclusão' : 'Alteração' }}
            </h2>
          </div>
    </div>
      <form [formGroup]="fr" (ngSubmit)="salvar()" class="form-layout">
        <div class="row">
          <div class="col-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Id</mat-label>
              <input matInput 
                     formControlName="id" 
                     disabled 
                     title="id">
            </mat-form-field>
          </div>
          <div class="d-flex col-6 gap-1">
            <!-- Categoria com autocomplete editável -->
            <mat-form-field 
              appearance="outline" 
              [ngClass]="this.fr.get('categoria')?.value == 'TI' || this.fr.get('categoria')?.value == 'Ti' ? 'w-50' : 'w-100'" 
              >
              <mat-label>Categoria</mat-label>
              <input
                type="text"
                matInput
                formControlName="categoria"
                title="categoria"
              >
            </mat-form-field>
            <mat-form-field 
              appearance="outline"
              *ngIf="this.fr.get('categoria')?.value == 'TI' || this.fr.get('categoria')?.value == 'Ti' " 
              [ngClass]="this.fr.get('categoria')?.value == 'TI' || this.fr.get('categoria')?.value == 'Ti' ? 'w-50' : 'w-100'" 
              >
              <mat-label>SubCategoria</mat-label>
              <input
                type="text"
                matInput
                formControlName="subCategoria"
                title="Sub-Categoria"
              >
            </mat-form-field>
          </div>
        </div>

        <div class="row">
          <div class="col-12 w-50">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Nome</mat-label>
              <input matInput 
                     formControlName="name" 
                     title="nome">
            </mat-form-field>
          </div>
          <div class="col-12 w-50">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Link</mat-label>
              <input 
                matInput 
                formControlName="url"
                title="lnk"
                >
            </mat-form-field>
          </div>
        </div>

        <div class="row">

          <div class="col-12 w-100">

            <mat-form-field 
              class="w-100 example-chip-list" 
              appearance="fill">

                <mat-label>Lista de Tags</mat-label>

                <mat-chip-grid #chipGrid aria-label="Preencha Tag">
                  
                  <mat-chip-row *ngFor="let tag of ArrTags" (removed)="remove(tag)">
                    
                    {{tag}}

                    <button type="button" matChipRemove [attr.aria-label]="'remove ' + tag">
                      <mat-icon>X</mat-icon>
                    </button>

                  </mat-chip-row>

                </mat-chip-grid>

                <input 
                  placeholder="New tag" 
                  #tagInput 
                  [formControl]="tagCtrl"
                  [matChipInputFor]="chipGrid" 
                  [matAutocomplete]="auto"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="add($event)"
                  />

                <mat-autocomplete 
                  #auto="matAutocomplete" 
                  (optionSelected)="selected($event)">

                  <mat-option *ngFor="let tag of filteredTags | async" [value]="tag">
                    {{tag}}
                  </mat-option>

                </mat-autocomplete>

            </mat-form-field>

          </div>

        </div>

        <div class="row" *ngIf="!showSite">
          <div class="col-12 w-100" >
            <!-- apiKey="wjhk6xg9dnu9q26sgcnopb1cjb4bc4pr7gfe7b9j6jxo6xts" -->

            <editor 
              apiKey="wjhk6xg9dnu9q26sgcnopb1cjb4bc4pr7gfe7b9j6jxo6xts" 
              [init]="init" 
              formControlName="descricao"
            />

          </div>
        </div>
        <div class="row">
          <div class="col-12 d-flex justify-content-between">
            <button 
              mat-flat-button 
              color="primary" 
              type="submit" 
              [disabled]="fr.invalid">
              {{ data.status === 'inclusao' ? 'Incluir' : 'Alterar' }}
            </button>
            <button mat-button type="button" (click)="fechar()">Fechar</button>
          </div>
        </div>
      </form>
  </div>
</mat-dialog-content>